<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>首页动画</title>
    <link rel="stylesheet" href="${contextPath}/static/phm/css/indexAnimation.css">
</head>
<body>
<div class="myContainer">
    <div class="textPicBox">
        <h3>整机诊断预测模型</h3>
        <img class="pic" src="${contextPath}/static/phm/images/strategy/mod_1.png" alt="整机诊断预测模型">
    </div>
    <div class="textPicBox">
        <h3>智能算法</h3>
        <div class="picBox aiBox">
            <div class="aiBox1">
                <div class="line"></div>
                <div class="line"></div>
                <div class="line"></div>
            </div>
            <div class="aiBox2">
                <div class="line"></div>
                <div class="line"></div>
                <div class="line"></div>
            </div>
            <div class="aiBox3">
                <div class="line"></div>

            </div>
            <div class="aiBox4">
                <div class="line"></div>
            </div>
            <div class="aiBox5">
                <div class="line"></div>
            </div>
        </div>
    </div>
    <div class="animationBox-right light">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </div>
    <div class="animationBox-center light">
        <div class="line"></div>
    </div>
    <div class="animationBox-left light">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </div>
</div>
<script src="${contextPath}/static/phm/asserts/js/jquery-2.2.4.js" type="text/javascript" charset="utf-8"></script>
<script>
    // waiting代表动画前的等待时间
    const lightObj = {
        "waiting": 0,
        "animationBox-right": 1,
        "waiting2": 3,
        "animationBox-center": 1,
        "waiting3": 0,
        "animationBox-left": 1,
    };
    const lightName = Object.keys(lightObj);
    const aiObj = {
        "waiting": .5,
        "aiBox1": .5,
        "aiBox2": .5,
        "aiBox3": .5,
        "aiBox4": .5,
        "aiBox5": .5
    };
    const aiName = Object.keys(aiObj);

    $(function () {
        let animationNext1 = animationGen1();
        let animationNext2 = animationGen2();

        /*整体进度动画*/
        start(animationNext1,lightObj);
        /*智神经网络动画*/
        start(animationNext2,aiObj);

        function clear() {//循环前重置
            $(".line").removeClass("animation", 0);
        }

        //开始动画
        function start(animationNext,obj) {
            animationCtr(0, animationNext,obj);
        }

        /*每一步动画的实现
        *  @param {number} i 第几步动画
        *  @param {fun} animationNext 传入本生成器
        *  @param {obj} obj 时间和动画控制对象
        * */
        function animationCtr(i, animationNext,obj) {
            let objName = Object.keys(obj);
            setTimeout(function () {
                let $line = animationNext.next(animationNext).value;
                if ($line) {
                    // console.log($line[0])
                    $line.find(".line").addClass("animate").css("animation-duration", obj[objName[i + 1]] + "s");
                    // console.log($line[0])
                }
            }, obj[objName[i]] * 1000);
        }

        //生成器函数，让每一步动画等待执行完毕
        function* animationGen1() {
            for (let i = 0; i < lightName.length; i++) {
                animationCtr(i, animationNext1,lightObj);
                yield $("." + lightName[i]);
            }
        }

        //神经网络 生成器函数，让每一步动画等待执行完毕
        function* animationGen2() {
            for (let i = 0; i < aiName.length; i++) {
                animationCtr(i, animationNext2,aiObj);
                yield $("." + aiName[i]);
            }
        }
    });


</script>
</body>
</html>