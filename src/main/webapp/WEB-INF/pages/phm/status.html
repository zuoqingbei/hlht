<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="PHW" content="phw二期"/>
		<title>实时状态</title>
		
		<link rel="stylesheet" href="${contextPath}/static/phm/css/common.css" />
		<link rel="stylesheet" href="${contextPath}/static/phm/css/status.css" />
		
		<script>
		 	window.onload = function(){
		        /*屏幕描述
				         一共 7x3 个屏幕，每一块屏幕是1360x768，
				         总共的大小就是9520x2304，比预计像素少7x6=42个像素。*/
				
		        var pageH = $(window).height();
		        var pageW = pageH * 16 * 7 / (9 * 3);
		        var bodyScale = pageH / 595;
		        var bodyFontSize = bodyScale * 100 + "%";
		        if (pageH > 2300) { // 如果是大屏幕(2304)
		            pageW -= 47
		        }
		        function pageResize() {
		            $("body").css("font-size", bodyFontSize);
		            $("#content").css("width", pageW);
		            $(".fullScreen_map").css("width", pageW);//全屏页面是绝对定位,宽度100%只能取自屏幕
		            console.log("~~~~~~~~~窗口高度：" + pageH + ",\n宽度:"+pageW+" \nbody字号：" + bodyFontSize)
		        }
		        pageResize()
	       }
   		</script>
	</head>
	<body>
		<div id="content">
			<!--head-->
			<div id="head">
				<h1>
					<a href="${contextPath}/fault/service">
						<img src="../static/phm/images/status/logo_haier_bold.png" alt="" />
					</a>
				</h1>
				<h2>基于物联网+大数据的最佳体验</h2>
			</div>
			<!--bottom-->
			<div id="bottom">
				<!--bottom left-->
				<div class="map-mod">
					<div id="myMap" style="width:100%;height:100%"></div>
				</div>
				<!--bottom bxbox-->
				<div class="bxbox">
					<div class="circle"></div>
					<div class="light"></div>
					<div class="piontline"></div>
					<div class="view center-block mybx">
			            <div class="box">
			                <div class="box_front"><strong></strong></div>
			                <div class="box_back"><strong></strong></div>
			                <div class="box_top"><strong></strong></div>
			                <div class="box_bottom"><strong>底部</strong></div>
			                <div class="box_left"><strong></strong></div>
			                <div class="box_right"><strong></strong></div>
			                <div class="box_compressor"><strong></strong></div>
			                <div class="box_compressor addon"><strong></strong></div>
			            </div>
			        </div>
					<div class="bxinfo">
						<div class="xinghao infobox">
							<p class="txt1">型号：</p>
							<p class="txt2" id="sncode">WD347T8948</p>
						</div>
						<div class="start infobox">
							<p class="txt1">启用时间：</p>
							<p class="txt2">2017-10-27</p>
						</div>
						<div class="address infobox">
							<p class="txt1">地址：</p>
							<p class="txt2" id="address">青岛市崂山区海尔路1号海尔信息产业园</p>
						</div>
						<div class="state infobox">
							<p class="txt1">健康状态：</p>
							<p class="txt2" id="status">良好</p>
						</div>
						<div class="time infobox">
							<p class="txt1">运行总时长：</p>
							<p class="txt2">179h</p>
						</div>
					</div>
				</div>
				<!--bottom right-->
				<div class="statusBox">
					<div class="leftBtn fyBtn" ></div>
					<div class="rightBtn fyBtn" ></div>
					<div class="titleBox">
						<div class="tnav syfx" onclick="useAnalysis()">使用分析</div>
						<div class="tnav sszt navActive" onclick="timeStatus()">实时状态</div>
						<div class="tnav ztqs">状态趋势</div>
						<div class="tnav gzzd">故障诊断</div>
						<div class="tnav gzyc">故障预测</div>
					</div>
					<div class="bottomState">
						<div class="state-box-contain">
							<div class="state-box">
								<!--实时状态-->
								<div class="leftStates" id="thirdPage"></div>
								<div class="leftStates" id="fourPage"></div>
								<div class="leftStates" id="firstPage" style="display:none;">
									<!-- <div class="jtState">
										<p class="stateTxt">壳体11</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid1"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">10℃</div>
									</div>
									<div class="jtState">
										<p class="stateTxt">蒸发器入口</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid2"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">40℃</div>
									</div>
									<div class="jtState">
										<p class="stateTxt">蒸发器出口</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid3"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">40℃</div>
									</div>
									<div class="jtState">
										<p class="stateTxt">冷凝器入口</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid4"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">40℃</div>
									</div>
									<div class="jtState">
										<p class="stateTxt">冷凝器出口</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid5"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">40℃</div>
									</div>
									<div class="jtState mt1">
										<p class="stateTxt">环境</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid6"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">40℃</div>
									</div>
									<div class="jtState mt1">
										<p class="stateTxt">转速</p>
										<div class="canvBox">
											<div id="zsCanvas" style="width:100%;height:100%"></div>
										</div>
									</div>
									<div class="jtState mt1">
										<p class="stateTxt">排气压力</p>
										<div class="canvBox">
											<div id="pqylCanvas" style="width:100%;height:100%"></div>
										</div>
									</div>
									<div class="jtState mt1">
										<p class="stateTxt">加速度</p>
										<div class="canvBox">
											<div id="jsdCanvas" style="width:100%;height:100%"></div>
										</div>
									</div>
									<div class="jtState mt1">
										<p class="stateTxt">制冷量</p>
										<div class="canvBox">
											<div id="zllCanvas" style="width:100%;height:100%"></div>
										</div>
									</div> -->
								</div>
								<div class="leftStates" id="secondPage" style="display:none;">
									<!-- <div class="jtState">
										<p class="stateTxt">冷凝器入口</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid4"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">40℃</div>
									</div>
									<div class="jtState">
										<p class="stateTxt">冷凝器出口</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid5"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">40℃</div>
									</div>
									<div class="jtState">
										<p class="stateTxt">环境</p>
										<div class="myState"></div>
										<div class="track">
											<div class="liquid liquid6"></div>
										</div>
										<div class="max">100</div>
									    <div class="mid">50</div>
									    <div class="min">0</div>
									    <div class="tempTxt">40℃</div>
									</div> -->
								</div>
								
								<!--使用分析-->
								<div class="syfxBox" id="analysisFirstPage">
									<!-- <div class="problemBox ">
										<div class="imgBox">
											<img src="../static/phm/images/status/kgmfs.jpg" alt="" />
										</div>
										<div class="rightInfo">
											<h6>开关门频繁</h6>
											<p>当前程度：</p>
											<p>严重</p>
										</div>
									</div>
									<div class="problemBox margleft">
										<div class="imgBox">
											<img src="../static/phm/images/status/kmsjgc.png" alt="" />
										</div>
										<div class="rightInfo">
											<h6>开门时间过长</h6>
											<p>当前程度：</p>
											<p>轻微</p>
										</div>
									</div>
									<div class="problemBox margtop">
										<div class="imgBox">
											<img src="../static/phm/images/status/fzgd.png" alt="" />
										</div>
										<div class="rightInfo">
											<h6>负载过大</h6>
											<p>当前程度：</p>
											<p>中等</p>
										</div>
									</div>
									<div class="problemBox margleft margtop">
										<div class="imgBox">
											<img src="../static/phm/images/status/ajsjgd.jpg" alt="" />
										</div>
										<div class="rightInfo">
											<h6>按键时间过短</h6>
											<p>当前程度：</p>
											<p>良好</p>
										</div>
									</div> -->
								</div>
								
								<div class="syfxBox" id="analysisSecondPage">
									<!-- <div class="problemBox ">
										<div class="imgBox">
											<img src="../static/phm/images/status/ajsjgd.jpg" alt="" />
										</div>
										<div class="rightInfo">
											<h6>按键时间过短</h6>
											<p>当前程度：</p>
											<p>良好</p>
										</div>
									</div> -->
								</div>
								
								<!--状态趋势-->
								<div class="ztqsBox">
									<!--<iframe src="http://47.95.109.158/#/product/20171026BX001" width="100%" height="100%"></iframe>-->
								</div>
							</div>
						</div>
						
					</div>
				</div>
			</div>
		</div>
		
		
		
		<script src="${contextPath}/static/phm/asserts/echarts/echarts-all-2.2.7.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="${contextPath}/static/phm/asserts/js/jquery-2.2.4.js"  type="text/javascript" charset="utf-8"></script>
		<script src="${contextPath}/static/phm/asserts/js/swfobject.js"  type="text/javascript" charset="utf-8"></script>
		
		<script src="${contextPath}/static/phm/js/status.js" type="text/javascript" charset="utf-8"></script>
	
	<!--陈新   -->
		<!--实时状态  -->
			<script type="text/javascript" charset="utf-8">
			var sncode="";//定义sncode 
			
			var bodyScale=$(window).height()/595;
			var that=this;
			<!--**********************转速 初始化***************************************   -->
				function speedometer(value,times,max,min,title,label){
					var zs = echarts.init(document.getElementById("zsCanvas"+times));
					var zsOption={

							title:{
								text:label,
								x:40*bodyScale,
								y:70*bodyScale,
								textStyle:{
									color:'#64ccff',
									fontSize:13*bodyScale
								}
							},
//							 tooltip : {
//						        formatter: "{a} <br/>{b} : {c}"
//						    },
						    series : [
						        {
						            name:title,
						            type:'gauge',
						            detail : {formatter:'{value}',
						            	textStyle:{
						            		color:'#64ccff',
						            		fontSize:15*bodyScale,
						            		fontWeight:600,
						            	}
						            },
						            data:[{value: value}],
						          itemStyle:{
						          	color:'#64ccff'
						          },
						          startAngle:200,
						          endAngle:-20,
						          min:min,
						          max:max,
						          //radius:"[2%,75%]",
						          radius:["80%","100%"],
						          center:["50%","60%"],
						          axisLine:{
						          	show:true,
						            lineStyle:{
						            	color:'#64ccff',
						              width:15*bodyScale
						            }
						          },
						          axisLabel:{
						          	textStyle:{
						          		color:'#fff'
						          	}
						          },
						          splitLine:{
						          	length:bodyScale,
						          	lineStyle:{
						          		color:'#64ccff',
						          		width:2*bodyScale
						          	}
						          },
						          axisTick:{
						          	show:false
						          },
						          pointer:{
						          	length:40*bodyScale,
						            width:5*bodyScale,
						            color:'#dd0'
						          },
						          title:{
						          	show:true,
						          	
						          }
						        }
						    ]
						
					}
					
					zs.setOption(zsOption);
				}
			/* **********************************仪表初始化 **************************************  */
				function gauge(value,times,max,min,title,label,percent){
					var guage = echarts.init(document.getElementById("Canvas"+times));
					var option={
					title:{
						text:label,
						x:40*bodyScale,
						y:50*bodyScale,
						textStyle:{
							color:'#64ccff',
							fontSize:13*bodyScale
						}
					},
					 tooltip : {
				        formatter: "{a} <br/>{b} : {c}"
				    },
				    series : [
				        {
				            name:title,
				            type:'gauge',
				            detail : {formatter:'{value}',
				            	textStyle:{
				            		color:'#64ccff',
				            		fontSize:15*bodyScale,
				            		fontWeight:600,
				            	},
				            	offsetCenter:[0,'-5%']
				            },
				            data:[{value: value}],
				          itemStyle:{
				          	color:'#64ccff'
				          },
				          startAngle:180,
				          endAngle:0,
				          min:min,
				          max:max,
				          //radius:"[2%,75%]",
				          radius:["80%","100%"],
				          center:["50%","60%"],
				          axisLine:{
				          	show:true,
				            lineStyle:{
				            	color:[
				            		[percent,'#64ccff'],
				            		[1,'#0a5365']
				            	],
				              width:15*bodyScale
				            }
				          },
				          splitLine:{
				          	show:false
				          },
				          axisTick:{
				          	show:false
				          },
				          axisLabel:{
				          	show:false
				          },
				          pointer:{
				          	length:0,
				            width:0,
				            color:'#dd0'
				          },
				          title:{
				          	show:true,
				          	
				          }
				        }
				    ]
				
					}
					guage.setOption(option);
				
			}
			var sortArr=["T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","U1","U2","R1"];
			function sort(monitorConf){
				var result=[];
				var other=[];
				for(var x=0;x<sortArr.length;x++){
					$.each(monitorConf,function(index,item){
						if(item.feature==sortArr[x]){
							result.push(item);
							return true ;
						};
					});
				};
				
				$.each(monitorConf,function(index,item){
					if(sortArr.indexOf(item.feature)==-1){
						other.push(item);
						return true ;
					};
				});
				return result.concat(other);
			}
			/* ********************************************************************************* */
			<!--实时状态初始化  -->
			function timeStatus(){
				var times=0;
				if(sncode==""||sncode==undefined){
					return;
				}
				$.ajax({
					//url:"http://localhost:8088/api/yzd/product/"+sncode,
					url:"http://47.95.109.158/api/yzd/product/"+sncode,
					type:"get",
					success:function(data){
						console.log(data.monitorConf)
						data.monitorConf=sort(data.monitorConf);
						$("#firstPage").html("");
						$("#secondPage").html("");
						//debugger;
						var location=data.location;
						var info=data.info;
						var S14=info['S14'];
						
						var monitorConf=data.monitorConf;
							for( var index in monitorConf){
								var monitorConfSingle=monitorConf[index];
								var param=monitorConfSingle.param;
								var title="";
								var label="";
								var max="";
								var min="";
								var actualStatus="";
								var type=monitorConfSingle.type;
								var feature=monitorConfSingle.feature;
									 actualStatus=info[feature];
								var charts="";
							
									 title=param.title;
									 label=param.label;
									 max=param.max;
									 min=param.min;
								if(times==6){
									//S14=1;
									if(!S14){
										var image=
											"<div class='jtState mt1'>"+
											"<p style='margin-left:17%;' class='stateTxt'>冰箱开关门</p>"+
											
										    "<div style='margin-top: 14%;'><span style='margin:27% 16%;display:block;'>开关门缺失数据</span></div>"+
										"</div>";
										$("#firstPage").append(image);
									}else if(S14=="0"){
										var image=
											"<div class='jtState mt1'>"+
												"<p class='stateTxt'>冰箱开关门</p>"+
												"<div class='bxDoor'>"+
													"<div class='bxImgLeft'>"+
														"<img src='${contextPath}/static/phm/images/status/bxClose.png' alt='' />"+
													"</div>"+
													"<p class='bxTxt'>当前状态:<br /><span>关门</span></p>"+
												"</div>"+
											"</div>";
										$("#firstPage").append(image);
									}else if(S14=="1"){
										var image=
											"<div class='jtState mt1'>"+
												"<p class='stateTxt'>冰箱开关门</p>"+
												"<div class='bxDoor'>"+
													"<div class='bxImgLeft'>"+
														"<img src='${contextPath}/static/phm/images/status/bxOpen.png' alt='' />"+
													"</div>"+
													"<p class='bxTxt'>当前状态:<br /><span>开门</span></p>"+
												"</div>"+
											"</div>";
										$("#firstPage").append(image);
									}
									times+=1;
								}
							/* 	var type=monitorConfSingle.type;
								var feature=monitorConfSingle.feature;
									 actualStatus=info[feature];
								var charts=""; */
								//if(times>0){debugger;}
								//if(!max||!min||!actualStatus)
									if(times>23){
										/* $("#analysisFirstPage").html(first);
										$("#analysisSecondPage").html(second); */
										continue;}
								if(!max&&max!="0"){
									type="text";
									label="最大值数据缺失";
								}else if(!min&&min!="0"){
									type="text";
									label="最小值数据缺失";
								}else if(!actualStatus&&actualStatus!="0"){
									type="text";
									label="实际值数据缺失";
								}
							var changeClass="";
								if(times%12>5){
									changeClass="mt1";
								}
								if(type=="thermometer"){
									times+=1;
									charts+=
									"<div class='jtState "+changeClass+"'>"+
										"<p class='stateTxt'>"+title+"</p>"+
										"<div class='myState'></div>"+
										"<div class='track'>"+
											"<div class='liquid liquid"+times+"'></div>"+
										"</div>"+
										"<div class='max'>"+max+"</div>"+
									    "<div class='mid'></div>"+
									    "<div class='min'>"+min+"</div>"+
									    "<div class='tempTxt'>"+actualStatus+"</div>"+
									"</div>";
									var myarr=new Array();
									
									
									
									if(times>12){
										$("#secondPage").append(charts);
									}else{
										$("#firstPage").append(charts);
									}
									if(actualStatus==undefined){actualStatus=(max+min)/2;}
									if(actualStatus<min){min=actualStatus-4;}
									 myarr[0]=["liquid"+times,max,min,actualStatus,"℃"];
									 Status.liquidMove(myarr);
								}else if(type=="text"){
									
									times+=1;
									charts+=
										"<div class='jtState "+changeClass+"'>"+
											"<p style='margin-left:17%;' class='stateTxt'>"+title+"</p>"+
											
										    "<div style='margin-top: 14%;'><span style='margin:27% 16%;display:block;'>"+label+"</span></div>"+
										"</div>";
									if(times>12){
										$("#secondPage").append(charts);
									}else{
										$("#firstPage").append(charts);
									}
								}
								
							}
						/*****************************************************************************************************/	
							for( var index in monitorConf){
								var monitorConfSingle=monitorConf[index];
								var param=monitorConfSingle.param;
								var title="";
								var label="";
								var max="";
								var min="";
								var actualStatus="";
								var type=monitorConfSingle.type;
								var feature=monitorConfSingle.feature;
									 actualStatus=info[feature];
								var charts="";
							
									 title=param.title;
									 label=param.label;
									 max=param.max;
									 min=param.min;
								/**************************************/
									 if(times==6){
										//S14=1;
										if(!S14){
											var image=
												"<div class='jtState mt1'>"+
												"<p style='margin-left:17%;' class='stateTxt'>冰箱开关门</p>"+
												
											    "<div style='margin-top: 14%;'><span style='margin:27% 16%;display:block;'>开关门缺失</span></div>"+
											"</div>";
											$("#firstPage").append(image);
										}else if(S14=="0"){
											var image=
												"<div class='jtState mt1'>"+
													"<p class='stateTxt'>冰箱开关门</p>"+
													"<div class='bxDoor'>"+
														"<div class='bxImgLeft'>"+
															"<img src='${contextPath}/static/phm/images/status/bxClose.png' alt='' />"+
														"</div>"+
														"<p class='bxTxt'>当前状态:<br /><span>关门</span></p>"+
													"</div>"+
												"</div>";
											$("#firstPage").append(image);
										}else if(S14=="1"){
											var image=
												"<div class='jtState mt1'>"+
													"<p class='stateTxt'>冰箱开关门</p>"+
													"<div class='bxDoor'>"+
														"<div class='bxImgLeft'>"+
															"<img src='${contextPath}/static/phm/images/status/bxOpen.png' alt='' />"+
														"</div>"+
														"<p class='bxTxt'>当前状态:<br /><span>开门</span></p>"+
													"</div>"+
												"</div>";
											$("#firstPage").append(image);
										}
										times+=1;
									}
									 if(times>23){
											/* $("#analysisFirstPage").html(first);
											$("#analysisSecondPage").html(second); */
											continue;}
										if(!max&&max!="0"){
											type="text";
											label="最大值数据缺失";
										}else if(!min&&min!="0"){
											type="text";
											label="最小值数据缺失";
										}else if(!actualStatus&&actualStatus!="0"){
											type="text";
											label="实际值数据缺失";
										}
							var changeClass="";
								if(times%12>5){
									changeClass="mt1";
								}
								 if(type=="speedometer"){
									
									times+=1;
									charts+=
										"<div class='jtState "+changeClass+"'>"+
											"<p class='stateTxt'>"+title+"</p>"+
											"<div class='canvBox'>"+
												"<div id='zsCanvas"+times+"' style='width:100%;height:100%'></div>"+
											"</div>"+
										"</div>";
									if(times>12){
										$("#secondPage").append(charts);
									}else{
										$("#firstPage").append(charts);
									}
									speedometer(actualStatus,times,max,min,title,label);
								}else if(type=="gauge"){
									times+=1;
									charts+=
										"<div class='jtState "+changeClass+"'>"+
											"<p class='stateTxt'>"+title+"</p>"+
											"<div class='canvBox'>"+
												"<div id='Canvas"+times+"' style='width:100%;height:100%'></div>"+
											"</div>"+
										
										"</div>";
									if(times>12){
										$("#secondPage").append(charts);
									}else{
										$("#firstPage").append(charts);
									}
									
									var percent=(actualStatus-min)/(max-min);
									gauge(actualStatus,times,max,min,title,label,percent);
									
								}else if(type=="text"){
									
									times+=1;
									charts+=
										"<div class='jtState "+changeClass+"'>"+
											"<p style='margin-left:17%;' class='stateTxt'>"+title+"</p>"+
											
										    "<div style='margin-top: 14%;'><span style='margin:27% 16%;display:block;'>"+label+"</span></div>"+
										"</div>";
									if(times>12){
										$("#secondPage").append(charts);
									}else{
										$("#firstPage").append(charts);
									}
								}
	
							}
						/*******/
						//	<div class="leftStates" id="thirdPage"></div>
						//	<div class="leftStates" id="fourPage"></div>
							$("#thirdPage").html($("#firstPage").html());
							$("#fourPage").html($("#secondPage").html());
	
					},
					//error:function(){alert("实时加载错误");}
				
				});
				//Status.liquidMove(myarr);
				
			}
			/**********************************使用分析 **************************************************/
			function useAnalysis(){
				if(sncode==""){
					return;
				}
					$.ajax({
						url:"${contextPath}/deviceUseAnalysis/getDeviceUseAnalysisByDeviceSncode",
						type:"get",
						data:{'device_info_sncode':sncode},
						success:function(data){
							var f=1;
								var first="";var second="";
								var margleft=""; var margtop="";
							$.each(data,function(index,element){
								 if(f%3!=1){
									 margleft="margleft";
								 }
								 if(f%6>3){
									 margtop="margtop";
								 }
									var content=
										"<div class='problemBox "+margleft+" "+margtop+"'>"+
											"<div class='imgBox '>"+
												"<img src='${contextPath}/static/phm/images/"+element.imageurl+"' alt='' />"+
											"</div>"+
											"<div class='rightInfo'>"+
												"<h6>"+element.description+"</h6>"+
												"<p>当前程度：</p>"+
												"<p>"+element.status+"</p>"+
											"</div>"+
										"</div>";
									if(f>6){
										second+=content;
									}else{
										first+=content;
									}
									margleft="";
									margtop="";
									f+=1;
								
								
								
							});
							$("#analysisFirstPage").html(first);
							$("#analysisSecondPage").html(second);
						},
						//error:function(){alert("使用分析加载错误 ");}
						
						
						
					});
				
				
				
			}
			/***********************************地图 *******************************************************/
		function mapChina(serious,general,light,good,arr,geoCoord){
				var myMapCharts = echarts.init(document.getElementById("myMap"));
				var mapChartsOptions = {
					dataRange: {
				        min : 1,
				        max : 125,
				        precision:0,
				        itemWidth:20*bodyScale,
						itemHeight:10*bodyScale,
				        calculable : true,//不可拖动
				        padding:10*bodyScale,
				        color: ['aqua','lime', 'yellow','orange','#ff3333'],
				        textStyle:{
				            color:'#fff',
				            fontSize:13*bodyScale
				        }
				    },
				    tooltip: {
				         show: false, //不显示提示标签
			            formatter: '{b}', //提示标签格式
			            backgroundColor:"#ff7f50",//提示标签背景颜色
			            textStyle:{
			            	color:"#fff",
				        	fontSize:16*bodyScale
			            } //提示标签字体颜色
			        },
					series : [
				        {
				            name: '全国',
				            type: 'map',
				            mapType: 'china',
				            clickable:false,
				         /* 	geoCoord: {
				                '上海': ["121.4648","31.2891"],
				                '基准': ["156","48"],
				                address
						 },  */
							geoCoord:geoCoord,
				            itemStyle: {
				                normal: {
				                	color:'#0091d1',
				                    borderWidth: 1.5*bodyScale,//区域边框宽度
				                    borderColor: '#000619',//区域边框颜色
				                    areaColor:'#0091d0',//区域颜色
				                },
				                emphasis: {
//				                    color:"#00e673",
				                }
			           	 	},
				            data:[],
				            markLine : {
				                smooth:true,
				                smoothness:0,
				                symbol:['circle','none'],
				                symbolSize:[10*that.bodyScale,10*that.bodyScale],
				                effect : {
				                    show: true,
				                    scaleSize: 1,
				                    period: 15,//运动周期
				                    color: '#fff',
				                    shadowBlur: 10
				                },
				                itemStyle : {
				                    normal: {
				                        borderWidth:1*that.bodyScale,
				                        lineStyle: {
				                            type: 'solid',
				                            color:'#64ccff',
				                            shadowBlur: 10
				                        }
				                    }
				                },
				            	 data : arr
				            },
				        },
				        {
				            name: '良好',
				            type: 'map',
				            mapType: 'china',
				            data:[],
				            markPoint : {
				                symbol:'circle',
			            		symbolSize:5*bodyScale,
				                effect : {
				                    show: true,
				                    shadowBlur : 0,
				                    period:5
				                },
				                itemStyle:{
				                    normal:{
				                    	color:'lime',
				                        label:{show:false}
				                    },
				                    emphasis: {
				                        label:{position:'top'}
				                    }
				                },
/* 				                data :[{image: "asserts/video/3theA.mp4", sncode: "7", address: "上海", kind: "上海", name: "良好", sncode:"7",coord: [121, 31]}]
 */				                data:good
				            }
				            
				        },
				        {
				            name: '一般',
				            type: 'map',
				            mapType: 'china',
				            data:[],
				            markPoint : {
				                symbol:'circle',
			            		symbolSize:5*bodyScale,
				                effect : {
				                    show: true,
				                    shadowBlur : 0,
				                    period:5
				                },
				                itemStyle:{
				                    normal:{
				                    	color:'#00ffff',
				                        label:{show:false}
				                    },
				                    emphasis: {
				                        label:{position:'top'}
				                    }
				                },
				                data :general
				            }
				        } ,
				        
				        {
				            name: '轻微',
				            type: 'map',
				            mapType: 'china',
				            data:[],
				            markPoint : {
				                symbol:'circle',
			            		symbolSize:5*bodyScale,
				                effect : {
				                    show: true,
				                    shadowBlur : 0,
				                    period:5
				                },
				                itemStyle:{
				                    normal:{
				                    	color:'#990033',
				                        label:{show:false}
				                    },
				                    emphasis: {
				                        label:{position:'top'}
				                    }
				                },
				                data :light
				            }
				        } ,
				        {
				            name: '严重',
				            type: 'map',
				            mapType: 'china',
				            data:[],
				            markPoint : {
				                symbol:'circle',
			            		symbolSize:5*bodyScale,
				                effect : {
				                    show: true,
				                    shadowBlur : 0,
				                    period:5
				                },
				                itemStyle:{
				                    normal:{
				                    	color:'red',
				                        label:{show:false}
				                    },
				                    emphasis: {
				                        label:{position:'top'}
				                    }
				                },
				                data :serious
				            }
				        } 
				        
				        
				    ]
				}
				myMapCharts.setOption(mapChartsOptions);
			
				
				myMapCharts.on('click',function(param){
					
					var tempSncode=sncode;
					sncode=param.data.sncode;
					var name = param.data.name;
					$("#sncode").html(sncode);
					$("#address").html(name);
					$("#status").html(param.data.status);
					 arr=[ [{name:name},{name:'基线'}] ];
					
				
					$("#firstPage").html("");
					$("#secondPage").html("");
					$("#analysisFirstPage").html("");
					$("#analysisSecondPage").html("");
					useAnalysis();//更新使用分析
					timeStatus();//更新实时状态
					mapChartsOptions.series[0].markLine.data=arr;
					myMapCharts.clear();
					myMapCharts.setOption(mapChartsOptions);
					
		              	/**********************/	
		              	
		              	
		              	
					var navs = $(".tnav");
					for(var nav of navs){
						$(nav).removeClass("navActive");
					}
					//给点击的nav加active样式
					$(".sszt").addClass("navActive");
					
					//切换内容
					$(".leftStates").css("display","block");
					$(".syfxBox").css("display","none");
					$(".ztqsBox").css("display","none");
					//改变宽度
					$(".state-box").css("width","200%");	
				});
			
			}
			/*********************************************************************************/
			$(function(){
				//setTimeout(function(){
				//	mapChina()
			//	},2000);
				
				$.ajax({
					url:"${contextPath}/deviceInfo/findDeviceInfoStatusGroup",
					type:"get",
					success:function(data){
						var serious=new Array();
						var general=new Array();
						var light=new Array();
						var good=new Array();
						 serious=data.serious;
						 general=data.general;
						 light=data.light;
						 good=data.good;
						var geoCoord={'基线':["140","32"]};
						var address=data.address;
						for(var i=0;i<address.length;i++){
							var obj=address[i];
							for(var j in obj){
								geoCoord[j]=obj[j];
							}
						}
						 var arr=[[]];
						 if(good.length>0){
							 arr=[ [{name:good[0].name},{name:'基线'}] ];
						 }else if(light.length>0){
							 arr=[ [{name:light[0].name},{name:'基线'}] ];
						 }else if(general.length>0){
							 arr=[ [{name:general[0].name},{name:'基线'}] ];
						 }else if(serious.length>0){
							 arr=[ [{name:serious[0].name},{name:'基线'}] ];
						 }
					 	sncode=good[0].sncode;
						$("#sncode").html(sncode);
						$("#address").html(good[0].name);
						$("#status").html(good[0].status);
						
						Status.delayIframe(sncode);
						//document.getElementById("video").src="${contextPath}/static/phm/"+good[0].image;
					
						//var arr=[ [{name:good[0].name},{name:'基线'}] ];
 
						useAnalysis();//更新使用分析
						timeStatus();//更新实时状态 
						setTimeout(function(){
							mapChina(serious,general,light,good,arr,geoCoord);
						},1000);
						 setInterval(function(){
							timeStatus();
						},3000); 
						
					},
				//	error:function(){alert("加载 地图信息错误 ");}
					
					
				})
			});
			//function markLineOption
		
		</script>
	</body>
</html>
